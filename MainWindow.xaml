<hc:Window
  x:Class="KeyboardLanguageIndicator.MainWindow"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:hc="https://handyorg.github.io/handycontrol"
  Title="Keyboard Language Indicator - Settings"
  Height="700"
  Width="600"
  WindowStartupLocation="CenterScreen"
  Background="{DynamicResource RegionBrush}"
  Closing="Window_Closing"
  StateChanged="Window_StateChanged"
  ResizeMode="CanMinimize"
>
  <hc:Window.Resources>
    <ContextMenu x:Key="TrayMenu">
      <MenuItem Header="Settings" Click="TrayIcon_DoubleClick" />
      <Separator />
      <MenuItem Header="Exit" Click="Exit_Click" />
    </ContextMenu>
    <Style x:Key="SliderRowStyle" TargetType="Grid">
      <Setter Property="Margin" Value="0,0,0,15" />
    </Style>
  </hc:Window.Resources>
  <Grid Margin="15">
    <Grid.RowDefinitions>
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    <TabControl Grid.Row="0" Style="{StaticResource TabControlBaseStyle}" Margin="0,0,0,10">
      <!-- General Settings Tab -->
      <TabItem>
        <TabItem.Header>
          <TextBlock Text="General" FontSize="14" Padding="10,5" />
        </TabItem.Header>
        <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="5">
          <StackPanel Margin="15,20,15,10">
            <!-- Monitor Selector -->
            <hc:ComboBox
              x:Name="MonitorComboBox"
              hc:TitleElement.Title="Display Monitor"
              hc:TitleElement.TitlePlacement="Top"
              Style="{StaticResource ComboBoxExtend}"
              Margin="0,0,0,25"
              SelectionChanged="Settings_Changed"
            />
            <!-- Position Selector -->
            <hc:ComboBox
              x:Name="PositionComboBox"
              hc:TitleElement.Title="Notification Position"
              hc:TitleElement.TitlePlacement="Top"
              Style="{StaticResource ComboBoxExtend}"
              Margin="0,0,0,25"
              SelectionChanged="Settings_Changed"
            >
              <ComboBoxItem Content="Top Right" Tag="TopRight" />
              <ComboBoxItem Content="Top Left" Tag="TopLeft" />
              <ComboBoxItem Content="Top Center" Tag="TopCenter" />
              <ComboBoxItem Content="Bottom Right" Tag="BottomRight" />
              <ComboBoxItem Content="Bottom Left" Tag="BottomLeft" />
              <ComboBoxItem Content="Bottom Center" Tag="BottomCenter" />
              <ComboBoxItem Content="Center" Tag="Center" />
            </hc:ComboBox>
            <!-- Duration Slider -->
            <Grid Style="{StaticResource SliderRowStyle}">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="95" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="70" />
              </Grid.ColumnDefinitions>
              <TextBlock Text="Duration" VerticalAlignment="Center" FontWeight="Medium" />
              <Slider
                x:Name="DurationSlider"
                Grid.Column="1"
                Minimum="0.5"
                Maximum="10"
                TickFrequency="0.5"
                IsSnapToTickEnabled="True"
                ValueChanged="Settings_Changed"
                Margin="10,0"
              />
              <TextBlock
                Text="{Binding Value, ElementName=DurationSlider, StringFormat={}{0:N1}s}"
                Grid.Column="2"
                VerticalAlignment="Center"
                HorizontalAlignment="Right"
                Foreground="{DynamicResource PrimaryBrush}"
                FontWeight="SemiBold"
              />
            </Grid>
            <!-- Persistent Mode Checkbox -->
            <CheckBox
              x:Name="PersistentCheckBox"
              Content="Persistent Mode (Dismiss with Ctrl+Q)"
              Margin="0,5,0,20"
              Checked="Persistent_Changed"
              Unchecked="Persistent_Changed"
            />
            <!-- Font Size Slider -->
            <Grid Style="{StaticResource SliderRowStyle}">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="95" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="70" />
              </Grid.ColumnDefinitions>
              <TextBlock Text="Font Size" VerticalAlignment="Center" FontWeight="Medium" />
              <Slider
                x:Name="FontSizeSlider"
                Grid.Column="1"
                Minimum="12"
                Maximum="48"
                TickFrequency="1"
                IsSnapToTickEnabled="True"
                ValueChanged="Settings_Changed"
                Margin="10,0"
              />
              <TextBlock
                Text="{Binding Value, ElementName=FontSizeSlider, StringFormat={}{0:F0}}"
                Grid.Column="2"
                VerticalAlignment="Center"
                HorizontalAlignment="Right"
                Foreground="{DynamicResource PrimaryBrush}"
                FontWeight="SemiBold"
              />
            </Grid>
            <!-- Opacity Slider -->
            <Grid Style="{StaticResource SliderRowStyle}">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="95" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="70" />
              </Grid.ColumnDefinitions>
              <TextBlock Text="Opacity" VerticalAlignment="Center" FontWeight="Medium" />
              <Slider
                x:Name="OpacitySlider"
                Grid.Column="1"
                Minimum="0.1"
                Maximum="1"
                TickFrequency="0.05"
                IsSnapToTickEnabled="True"
                ValueChanged="Settings_Changed"
                Margin="10,0"
              />
              <TextBlock
                Text="{Binding Value, ElementName=OpacitySlider, StringFormat={}{0:P0}}"
                Grid.Column="2"
                VerticalAlignment="Center"
                HorizontalAlignment="Right"
                Foreground="{DynamicResource PrimaryBrush}"
                FontWeight="SemiBold"
              />
            </Grid>
          </StackPanel>
        </ScrollViewer>
      </TabItem>
      <!-- Appearance Tab -->
      <TabItem>
        <TabItem.Header>
          <TextBlock Text="Appearance" FontSize="14" Padding="10,5" />
        </TabItem.Header>
        <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="5">
          <StackPanel Margin="15,20,15,10">
            <!-- Application Theme -->
            <TextBlock
              Text="Application Theme"
              Margin="0,0,0,15"
              FontWeight="Bold"
              FontSize="15"
              Foreground="{DynamicResource PrimaryTextBrush}"
            />
            <CheckBox
              x:Name="DarkModeCheckBox"
              Content="Enable Dark Mode"
              FontSize="13"
              Margin="0,0,0,20"
              Checked="Theme_Changed"
              Unchecked="Theme_Changed"
            />
            <Separator Margin="0,0,0,25" Background="{DynamicResource BorderBrush}" />
            <!-- Notification Colors -->
            <TextBlock
              Text="Notification Colors"
              Margin="0,0,0,15"
              FontWeight="Bold"
              FontSize="15"
              Foreground="{DynamicResource PrimaryTextBrush}"
            />
            <TextBlock
              Text="Set default colors or configure custom colors for specific languages."
              TextWrapping="Wrap"
              Margin="0,0,0,20"
              FontSize="12"
              Foreground="{DynamicResource SecondaryTextBrush}"
            />
            <!-- Color Pickers -->
            <Grid Margin="0,0,0,20">
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              <!-- Background Color Picker -->
              <StackPanel Grid.Column="0" Margin="0,0,10,0">
                <TextBlock
                  Text="Background Color"
                  Margin="0,0,0,10"
                  FontSize="13"
                  FontWeight="Medium"
                  Foreground="{DynamicResource SecondaryTextBrush}"
                />
                <hc:ColorPicker
                  x:Name="BgColorPicker"
                  Width="250"
                  HorizontalAlignment="Left"
                  hc:InfoElement.Placeholder="Select Color"
                />
              </StackPanel>
              <!-- Text Color Picker -->
              <StackPanel Grid.Column="1" Margin="10,0,0,0">
                <TextBlock
                  Text="Text Color"
                  Margin="0,0,0,10"
                  FontSize="13"
                  FontWeight="Medium"
                  Foreground="{DynamicResource SecondaryTextBrush}"
                />
                <hc:ColorPicker
                  x:Name="TextColorPicker"
                  Width="250"
                  HorizontalAlignment="Left"
                  hc:InfoElement.Placeholder="Select Color"
                />
              </StackPanel>
            </Grid>
            <!-- Add Language Section -->
            <Border
              Padding="15"
              Background="{DynamicResource RegionBrush}"
              BorderBrush="{DynamicResource BorderBrush}"
              BorderThickness="1"
              CornerRadius="4"
              Margin="0,0,0,15"
            >
              <StackPanel>
                <TextBlock
                  Text="Language-Specific Colors"
                  FontWeight="SemiBold"
                  Margin="0,0,0,10"
                />
                <TextBlock
                  Text="Select a language, adjust the colors above, then add it to the list."
                  TextWrapping="Wrap"
                  Margin="0,0,0,15"
                  FontSize="12"
                  Foreground="{DynamicResource SecondaryTextBrush}"
                />
                <hc:ComboBox
                  x:Name="LanguageSelector"
                  Margin="0,0,0,15"
                  IsEditable="True"
                  hc:InfoElement.Placeholder="Select or type language"
                  hc:TitleElement.Title="Language"
                  hc:TitleElement.TitlePlacement="Top"
                  Style="{StaticResource ComboBoxExtend}"
                />
                <Button
                  Content="Add Language with Current Colors"
                  Click="AddLanguageConfig_Click"
                  Style="{DynamicResource ButtonPrimary}"
                  HorizontalAlignment="Stretch"
                />
              </StackPanel>
            </Border>
            <!-- Language List -->
            <TextBlock Text="Configured Languages" FontWeight="SemiBold" Margin="0,0,0,10" />
            <ListBox x:Name="LanguageConfigList" MinHeight="150" MaxHeight="300">
              <ListBox.ItemTemplate>
                <DataTemplate>
                  <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="150" />
                      <ColumnDefinition Width="*" />
                      <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <StackPanel>
                      <TextBlock Text="{Binding Name}" FontWeight="Bold" FontSize="14" />
                      <TextBlock
                        Text="{Binding Code}"
                        FontSize="11"
                        Foreground="{DynamicResource SecondaryTextBrush}"
                      />
                    </StackPanel>
                    <StackPanel
                      Grid.Column="1"
                      Orientation="Horizontal"
                      Margin="15,0,0,0"
                      VerticalAlignment="Center"
                    >
                      <Border
                        Width="30"
                        Height="20"
                        Background="{Binding BackgroundBrush}"
                        BorderBrush="Gray"
                        BorderThickness="1"
                        Margin="0,0,5,0"
                      />
                      <TextBlock
                        Text="BG"
                        VerticalAlignment="Center"
                        Margin="0,0,15,0"
                        FontSize="11"
                        Foreground="{DynamicResource SecondaryTextBrush}"
                      />
                      <Border
                        Width="30"
                        Height="20"
                        Background="{Binding TextBrush}"
                        BorderBrush="Gray"
                        BorderThickness="1"
                        Margin="0,0,5,0"
                      />
                      <TextBlock
                        Text="Text"
                        VerticalAlignment="Center"
                        FontSize="11"
                        Foreground="{DynamicResource SecondaryTextBrush}"
                      />
                    </StackPanel>
                    <Button
                      Grid.Column="2"
                      Content="Remove"
                      Click="RemoveLanguageConfig_Click"
                      Tag="{Binding Code}"
                      Style="{StaticResource ButtonDanger}"
                      Padding="10,5"
                    />
                  </Grid>
                </DataTemplate>
              </ListBox.ItemTemplate>
            </ListBox>
          </StackPanel>
        </ScrollViewer>
      </TabItem>
      <!-- Behavior Tab -->
      <TabItem>
        <TabItem.Header>
          <TextBlock Text="Behavior" FontSize="14" Padding="10,5" />
        </TabItem.Header>
        <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="5">
          <StackPanel Margin="15,20,15,10">
            <TextBlock
              Text="System Integration"
              Margin="0,0,0,15"
              FontWeight="Bold"
              FontSize="15"
              Foreground="{DynamicResource PrimaryTextBrush}"
            />
            <CheckBox
              x:Name="StartWithWindowsCheckBox"
              Content="Start automatically with Windows"
              Margin="0,0,0,12"
              FontSize="13"
              Checked="StartWithWindows_Changed"
              Unchecked="StartWithWindows_Changed"
            />
            <CheckBox
              x:Name="CheckForUpdatesCheckBox"
              Content="Check for updates automatically"
              Margin="0,0,0,12"
              FontSize="13"
              Checked="Settings_Changed"
              Unchecked="Settings_Changed"
            />
            <Button
              x:Name="CheckNowButton"
              Content="Check for Updates Now"
              Padding="15,5"
              Style="{StaticResource ButtonInfo}"
              Click="CheckForUpdates_Click"
            />
            <Separator Margin="0,10,0,20" Background="{DynamicResource BorderBrush}" />
            <TextBlock
              Text="Window Behavior"
              Margin="0,0,0,15"
              FontWeight="Bold"
              FontSize="15"
              Foreground="{DynamicResource PrimaryTextBrush}"
            />
            <CheckBox
              x:Name="MinimizeToTrayCheckBox"
              Content="Minimize to system tray when minimized"
              Margin="0,0,0,12"
              FontSize="13"
              Checked="Settings_Changed"
              Unchecked="Settings_Changed"
            />
            <CheckBox
              x:Name="CloseToTrayCheckBox"
              Content="Minimize to tray when closing window"
              Margin="0,0,0,12"
              FontSize="13"
              Checked="Settings_Changed"
              Unchecked="Settings_Changed"
            />
            <Border
              Margin="0,20,0,0"
              Padding="12"
              Background="{DynamicResource InfoBrush}"
              CornerRadius="4"
              BorderThickness="1"
              BorderBrush="{DynamicResource BorderBrush}"
            >
              <StackPanel>
                <TextBlock
                  Text="[i] Tip"
                  FontWeight="Bold"
                  FontSize="13"
                  Margin="0,0,0,5"
                  FontFamily="Segoe UI"
                />
                <TextBlock
                  Text="Double-click the system tray icon to open settings at any time."
                  FontSize="12"
                  TextWrapping="Wrap"
                  Foreground="{DynamicResource SecondaryTextBrush}"
                />
              </StackPanel>
            </Border>
          </StackPanel>
        </ScrollViewer>
      </TabItem>
      <!-- About Tab -->
      <TabItem>
        <TabItem.Header>
          <TextBlock Text="About" FontSize="14" Padding="10,5" />
        </TabItem.Header>
        <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="5">
          <StackPanel Margin="15,20,15,10" HorizontalAlignment="Center" MaxWidth="500">
            <TextBlock
              Text="Keyboard Language Indicator"
              FontSize="24"
              FontWeight="Bold"
              HorizontalAlignment="Center"
              Margin="0,20,0,10"
            />
            <TextBlock
              x:Name="VersionText"
              Text="Version 1.0.0"
              FontSize="14"
              HorizontalAlignment="Center"
              Foreground="{DynamicResource SecondaryTextBrush}"
              Margin="0,0,0,30"
            />
            <Border
              Padding="20"
              Background="{DynamicResource RegionBrush}"
              BorderBrush="{DynamicResource BorderBrush}"
              BorderThickness="1"
              CornerRadius="8"
              Margin="0,0,0,20"
            >
              <StackPanel>
                <TextBlock
                  Text="About This App"
                  FontWeight="Bold"
                  FontSize="16"
                  Margin="0,0,0,10"
                />
                <TextBlock
                  Text="A lightweight utility that displays on-screen notifications when you switch keyboard input languages."
                  TextWrapping="Wrap"
                  FontSize="13"
                  Margin="0,0,0,15"
                  Foreground="{DynamicResource SecondaryTextBrush}"
                />
                <TextBlock Text="Features:" FontWeight="SemiBold" Margin="0,0,0,8" />
                <TextBlock
                  Text="• Real-time language change notifications"
                  Margin="10,0,0,5"
                  FontSize="12"
                />
                <TextBlock Text="• Multi-monitor support" Margin="10,0,0,5" FontSize="12" />
                <TextBlock
                  Text="• Customizable colors per language"
                  Margin="10,0,0,5"
                  FontSize="12"
                />
                <TextBlock Text="• Dark mode support" Margin="10,0,0,5" FontSize="12" />
                <TextBlock Text="• System tray integration" Margin="10,0,0,5" FontSize="12" />
                <TextBlock Text="• Automatic updates" Margin="10,0,0,5" FontSize="12" />
              </StackPanel>
            </Border>
            <Button
              Content="View on GitHub"
              Style="{StaticResource ButtonPrimary}"
              HorizontalAlignment="Center"
              Padding="30,5"
              Margin="0,0,0,10"
              Click="ViewOnGitHub_Click"
            />
            <Button
              Content="Check for Updates"
              Style="{StaticResource ButtonInfo}"
              HorizontalAlignment="Center"
              Padding="25,5"
              Margin="0,0,0,20"
              Click="CheckForUpdates_Click"
              Width="149"
            />
            <TextBlock
              Text="Licensed under GNU GPL v3.0"
              FontSize="11"
              HorizontalAlignment="Center"
              Foreground="{DynamicResource SecondaryTextBrush}"
              Margin="0,20,0,0"
            />
          </StackPanel>
        </ScrollViewer>
      </TabItem>
    </TabControl>
    <!-- Test Button with proper icon -->
    <Button
      Grid.Row="1"
      HorizontalAlignment="Stretch"
      Height="42"
      Margin="0,10,0,0"
      FontSize="14"
      FontWeight="Medium"
      Style="{StaticResource ButtonSuccess}"
      Click="TestNotification_Click"
    >
      <StackPanel Orientation="Horizontal">
        <TextBlock Text="Show Test Notification" VerticalAlignment="Center" />
      </StackPanel>
    </Button>
  </Grid>
</hc:Window>
